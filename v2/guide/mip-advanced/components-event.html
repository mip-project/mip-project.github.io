<!DOCTYPE html>
<html mip>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <title>MIP 文档_移动网页加速器_MIP(Mobile Instant Pages_)MIP 组件通信</title>
    <meta name="description" content="MIP 组件是页面的一个独立单元，组件和组件之间的功能相对独立，能够并列使用，也可以相互嵌套使用。现在，我们假设一个交互场景，当点击一个弹层组件 mip-lightbox 的触发按钮触发弹层的时候，我们同时需要去隐藏页面的所有悬浮组件元素，避免悬浮组件元素对这个弹层造成视觉干扰。这个场景如何实现呢？当然，我们可以在触发弹层的时候，给所有悬浮组件通信，告知需要对其进行隐藏操作。所以，了解组件之间如何通信，对设计MIP功能组件具有十分重要的意义。">
    <link rel="canonical" href="/v2/guide/mip-advanced/components-event.html">
    <link rel="stylesheet" type="text/css" href="https://c.mipcdn.com/static/v2/mip.css">
    <link rel="icon" href="https://www.mipengine.org/favicon.ico">
    <!-- <link rel="stylesheet" href="https://bos.nj.bpc.baidu.com/assets/mip/projects/mip.css"> -->
    <!-- <link rel="stylesheet" href="http://172.18.19.102:8080/dist/mip.css"> -->
    <link rel="stylesheet" type="text/css" href="/src/style/dist/index.css">
  </head>
  <body>
<mip-fixed type="top" class="layout-navbar-fixed">
  <div class="layout-navbar">
    <a data-type="mip" href="/"><div class="navbar-logo"></div></a>
    <div class="navbar-menu">
      <ul class="navbar-menu-wrapper">
        <li class="navbar-item" ><a data-type="mip" href="/v2/index.html" class="menu-name" title="首页">首页</a></li>
        <li class="navbar-item active">
          <span class="menu-name" title="学习">学习<i class="arrow"></i></span>
          <ul class="navbar-sub-menu">
            <li class="navbar-sub-item"><a data-type="mip" href="/v2/guide/basic/newbie.html" title="使用文档">使用文档</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="/v2/components/index.html" title="组件列表">组件列表</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="/v2/api/index.html" title="API">API</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="/v2/codelabs/index.html" title="Codelab">Codelab</a></li>
          </ul>
        </li>
        <li class="navbar-item">
          <span class="menu-name" title="常用链接">常用链接<i class="arrow"></i></span>
          <ul class="navbar-sub-menu">
            <li class="navbar-sub-item"><a data-type="mip" href="http://www.cnblogs.com/mipengine" title="MIP 官方博客">MIP 官方博客</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="https://github.com/mipengine/mip2/tree/master/packages/mip-cli" title="MIP-CLI 本地开发工具">MIP-CLI 本地开发工具</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/validator/validate" title="MIP 代码校验工具">MIP 代码校验工具</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/validator/preview" title="MIP 效果预览工具">MIP 效果预览工具</a></li>
            <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/mippath.html" title="MIP PATH 转换工具">MIP PATH 转换工具</a></li>
          </ul>
        </li>
        <li class="navbar-item" ><a target="_blank" href="https://github.com/mipengine/mip2" class="menu-name" title="GitHub">GitHub</a></li>
        <li class="navbar-item" ><a target="_blank" href="https://www.mipengine.org" class="menu-name" title="回到旧版">回到旧版</a></li>
      </ul>
      <div class="navbar-indicator" m-bind:style="navbarStyle"></div>
    </div>
    <div class="navbar-toggle" on="tap:nav-sidebar.open"><i class="iconfont icon-bars"></i></div>
  </div>
</mip-fixed>

    <mip-sidebar
      id="nav-sidebar"
      layout="nodisplay"
      side="right"
      class="mip-hidden nav-sidebar"
    >
<div class="sidebar-fragment sidebar-nav-wrapper"
  m-bind:class="{hide:sidebarFragment!=='nav'}"
>
  <h1 on="tap:MIP.setData({sidebarFragment:m.sidebarSecondFragment})"><span>目录</span></h1>
  <ul class="navbar-menu-wrapper">
    <li class="navbar-item"><a data-type="mip" href="/v2/index.html" class="menu-name">首页</a></li>
    <li class="navbar-item">
      <span class="menu-name">学习</span>
      <ul class="navbar-sub-menu">
        <li class="navbar-sub-item"><a data-type="mip" href="/v2/guide/basic/newbie.html">使用文档</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="/v2/components/index.html">组件列表</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="/v2/api/index.html">API</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="/v2/codelabs/index.html">Codelab</a></li>
      </ul>
    </li>
    <li class="navbar-item">
      <span class="menu-name">常用链接</span>
      <ul class="navbar-sub-menu">
        <li class="navbar-sub-item"><a data-type="mip" href="http://www.cnblogs.com/mipengine">MIP 官方博客</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="https://github.com/mipengine/mip2/tree/master/packages/mip-cli">MIP-CLI 本地开发工具</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/validator/validate">MIP 代码校验工具</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/validator/preview">MIP 效果预览工具</a></li>
        <li class="navbar-sub-item"><a data-type="mip" href="https://www.mipengine.org/mippath.html">MIP PATH 转换工具</a></li>
      </ul>
    </li>
    <li class="navbar-item"><a data-type="mip" href="https://github.com/mipengine/mip2" class="menu-name">GitHub</a></li>
    <li class="navbar-item"><a data-type="mip" href="https://www.mipengine.org" class="menu-name">回到旧版</a></li>
  </ul>
</div>
<div class="sidebar-fragment navbar-secnav-wrapper"
  m-bind:class="{hide:sidebarFragment!=='guide'}"
>
  <h1 on="tap:MIP.setData({sidebarFragment:'nav'})"><span>使用文档</span></h1>
  <mip-sidenav m-bind:menu="menu" m-bind:chapters="chapters" m-bind:url="url"></mip-sidenav>
</div>
    </mip-sidebar>

<mip-fixed type="left" top="64px" class="layout-sidebar">
  <mip-sidenav m-bind:menu="menu" m-bind:chapters="chapters" m-bind:url="url">
  </mip-sidenav>
</mip-fixed>
<div class="layout-main-content">
  <div class="content-wrapper">
<p class="markdown-breadcrumb">
  <span>进阶教程</span><span class="split">/</span>  <span>MIP 组件间通信</span></p>
    <div class="markdown-body">
      <h1 id="mip-组件通信"><a href="#mip-组件通信" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>MIP 组件通信</h1><p>MIP 组件是页面的一个独立单元，组件和组件之间的功能相对独立，能够并列使用，也可以相互嵌套使用。现在，我们假设一个交互场景，当点击一个弹层组件 mip-lightbox 的触发按钮触发弹层的时候，我们同时需要去隐藏页面的所有悬浮组件元素，避免悬浮组件元素对这个弹层造成视觉干扰。这个场景如何实现呢？当然，我们可以在触发弹层的时候，给所有悬浮组件通信，告知需要对其进行隐藏操作。所以，了解组件之间如何通信，对设计MIP功能组件具有十分重要的意义。</p><p>MIP 的组件通信是通过 <code>EventEmitter</code> 方式来实现的，这里首先给大家介绍一下什么是 <code>EventEmitter</code>，让大家对这个技术点有一定的了解。</p><h2 id="eventemitter-简介"><a href="#eventemitter-简介" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>EventEmitter 简介</h2><p><code>EventEmitter</code> 是一个对事件进行监听的对象，采用了发布—订阅(观察者)的方式，使用内部 events 列表来记录注册的事件处理器，说白了就是为事件写回调函数，当触发一个事件后，会执行该事件对应的回调函数。</p><p>既然是观察者模式，那它的基本 API 就包含了观察者的一些基本的特征，如下面代码所示。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div></div><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventEmitter</span> </span>{
  <span class="hljs-comment">// 构造函数初始化</span>
  <span class="hljs-keyword">constructor</span> (opt) { ... }
  <span class="hljs-comment">// 绑定事件</span>
  on(name, handler) { ... }
  <span class="hljs-comment">// 解绑事件</span>
  off (name, handler) { ... }
  <span class="hljs-comment">// 绑定只执行一次的事件</span>
  once (name, handler) { ... }
  <span class="hljs-comment">// 触发事件</span>
  trigger (name) { ... }
  <span class="hljs-comment">// 设置事件执行上下文</span>
  setEventContext (context) { ... }
}</code></pre><p>上面的代码是从 MIP 开源项目的源码中直接抽取出来，在 <code>EventEmitter</code> 的原型上，实现了四个方法：</p><ul><li>on：注册事件，返回值为 this</li><li>off：撤销注册事件，返回值为该事件，没有则返回 null</li><li>once：执行一次事件，执行完了撤销该事件</li><li>trigger：触发事件。这个模块基础技术都是基于观察者的设计模式实现的，如果想更详细地分析全部源码，可以直接到 GitHub 上查看 <code>event-emiter.js</code> 文件。</li></ul><h2 id="mip组件事件机制具体实现"><a href="#mip组件事件机制具体实现" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>MIP组件事件机制具体实现</h2><p>对 <code>EventEmitter</code> 有基本了解之后，我们接下来看看在 MIP 组件中具体是如何实现的。首先，我们还是从源码分析开始，如下面代码所示。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div></div><code class="lang-js"><span class="hljs-comment">//引入模块 event-emitter</span>
<span class="hljs-keyword">import</span> EventEmitter <span class="hljs-keyword">from</span> <span class="hljs-string">'./util/event-emitter'</span>

<span class="hljs-comment">// customElement的原型上增加 addEventAction 接口</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomElement</span> </span>{
  ...
  addEventAction (<span class="hljs-comment">/* name, handler */</span>) {
    <span class="hljs-keyword">let</span> evt = <span class="hljs-keyword">this</span>._actionEvent
    <span class="hljs-keyword">if</span> (!evt) {
      evt = <span class="hljs-keyword">this</span>._actionEvent = <span class="hljs-keyword">new</span> EventEmitter()
      evt.setEventContext(<span class="hljs-keyword">this</span>)
    }

    evt.on.apply(evt, <span class="hljs-built_in">arguments</span>)
  }
  ...
}</code></pre><p>由上面代码可见，在 <code>customElement</code> 里面封装 <code>addEventAction</code> API，这个 API 通过 <code>EventEmitter</code> 模块实现。 在 MIP 组件代码中，就可以使用这个 API 进行事件的注册，如下面代码所示。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div></div><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"wrapper"</span>&gt;</span>
    counter: {{num}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    data() {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">num</span>: <span class="hljs-number">0</span>
      }
    },
    mounted() {
      <span class="hljs-keyword">let</span> customElement = <span class="hljs-keyword">this</span>.$element.customElement
      <span class="hljs-keyword">let</span> vm = <span class="hljs-keyword">this</span>
      <span class="hljs-comment">// 可以使用 this.$on('counter', function () {...}) 简写方式</span>
      customElement.addEventAction(<span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt, str</span>) </span>{
        vm.num += <span class="hljs-number">1</span>
      })
    }
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre><p>上述代码暴露一个 add 的事件行为。如果其他组件想调用这个组件的 add 事件行为，通过如下方式即可，如下面代码所示。</p><pre><div class="code-index"><div>1</div><div>2</div></div><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">mip-counter</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"counter"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mip-counter</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">on</span>=<span class="hljs-string">"tap:counter.add"</span>&gt;</span> 点击 +1 <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre><p>如上所示，当点击 button 时，就会触发 add 事件行为。没错，起作用的正是 <code>on=&quot;tap:counter.add&quot;</code> 这个属性，那 add 事件行为是如何触发的呢？同样，我们将用一段代码来解决大家的疑惑，如下面代码所示。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div></div><code class="lang-js"><span class="hljs-keyword">import</span> EventAction <span class="hljs-keyword">from</span> <span class="hljs-string">'./util/event-action'</span>
<span class="hljs-comment">/**
 * 处理`on="tap:xxx"` 这种事件绑定
 */</span>
<span class="hljs-keyword">let</span> viewer = {
  init () {
    <span class="hljs-keyword">this</span>.setupEventAction()
  },
  <span class="hljs-comment">// 处理`on="tap:xxx"` 这种事件绑定</span>
  setupEventAction () {
    <span class="hljs-keyword">let</span> hasTouch = fn.hasTouch()
    <span class="hljs-keyword">let</span> eventAction = <span class="hljs-keyword">this</span>.eventAction = <span class="hljs-keyword">new</span> EventAction()
    <span class="hljs-keyword">if</span> (hasTouch) {
      <span class="hljs-comment">// 移动端</span>
      <span class="hljs-keyword">this</span>._gesture.on(<span class="hljs-string">'tap'</span>, event =&gt; {
        eventAction.execute(<span class="hljs-string">'tap'</span>, event.target, event)
      })
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// 兼容 PC</span>
      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'click'</span>, event =&gt; {
        eventAction.execute(<span class="hljs-string">'tap'</span>, event.target, event)
      }, <span class="hljs-literal">false</span>)
    }
  }
}</code></pre><p>上述代码来自 MIP 的 viewer 模块，前面章节有过介绍。这段代码专门处理 <code>on=&quot;tap:xxx&quot;</code> 这种事件绑定的情况。<code>eventAction.execute</code> 会方法会执分析 tap 后面的语句，执行对应组件暴露的事件。</p><h2 id="组件事件绑定语法"><a href="#组件事件绑定语法" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>组件事件绑定语法</h2><p>前面的例子展现如何在一个元素上利用 <code>on</code> 属性绑定一个 tap 事件，并触发特定组件的事件行为，接下来讲解下绑定事件的语法。 MIP 指定了通过on属性来绑定事件，on的值指定事件名称和事件触发后执行行为，具体的语法如下：</p><pre><div class="code-index"><div>1</div></div><code class="lang-js">on=<span class="hljs-string">"eventName:targetId[.actionName[(args)]]"</span></code></pre><p>其中 eventName 组件暴露的事件名，targetId 是 element 的 id 属性值，actionName 是事件触发后要执行的事件行为，args 为事件参数。</p><p>语法 <code>on</code> 支持监听多个事件，事件之间多个事件之间使用空格分开，例如：</p><pre><div class="code-index"><div>1</div></div><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">mip-counter</span> <span class="hljs-attr">on</span>=<span class="hljs-string">"succ:id.close  err:id.show"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mip-counter</span>&gt;</span></code></pre><p>注意：单个事件内部不能出现空格。</p><h2 id="自定义组件行为和事件"><a href="#自定义组件行为和事件" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>自定义组件行为和事件</h2><p>前面我们已经讲了如何暴露一个行为，我们可以在组件内部回调钩子通过调用 customElement 的 <code>addEventAction</code> 来暴露组件内部的行为，具体的语法如下：</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></div><code class="lang-js"><span class="hljs-keyword">this</span>.$element.customElement.addEventAction(
  <span class="hljs-string">'actionName'</span>,
  <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, str</span>) </span>{}
)

<span class="hljs-comment">// 推荐使用简写方式</span>
<span class="hljs-keyword">this</span>.$on(<span class="hljs-string">'actionName'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, str</span>))</span></code></pre><p><code>addEventAction</code> 方法接收两个参数，第一个参数为行为名称，第二个参数为回调函数，回调函数的第一个参数为事件对象，由派发事件的传递过来，后续参数为 <code>on</code> 属性语法的参数传递过来，由于 HTML 属性值必须为 String 类型，所以这里的 str 参数也是 String 类型，使用时需要自行转换。</p><p>那如何自定义事件呢？我们通过在组件内定义派发事件来暴露事件，具体方法如下：</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div></div><code class="lang-js">MIP.viewer.eventAction.execute(eventName, element, event)

<span class="hljs-comment">// 推荐使用简写方式</span>
<span class="hljs-keyword">this</span>.$emit(eventName, event)</code></pre><p><code>execute</code> 方法的第一个参数为事件名，第二个参数为组件元素实例，第三个参数是事件对象，可通过该参数传递数据给通过 <code>addEventAction</code> 注册的回调函数，通过第一个参数 event 获取。简写方式 <code>this.$emit</code> 省略了第二个参数 element，内部直接绑定当前组件对应的 element。</p><p>通过 <code>on</code> 属性语法，配合 <code>addEventAction</code> 和 <code>viewer.eventAction.execute</code> 我们就可以轻松实现两个组件之间的通信。下面代码给我们展示了一个命名为 <code>mip-counter.vue</code> 的计数器组件。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div></div><code class="lang-html"><span class="hljs-comment">&lt;!-- mip-counter.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">tempalte</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> &gt;</span>
    counter: {{ count }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> {
  data() {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>
    }
  },
  mounted() {
    <span class="hljs-keyword">let</span> vm = <span class="hljs-keyword">this</span>
    <span class="hljs-comment">// 添加 add 行为</span>
    <span class="hljs-keyword">this</span>.$on(<span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, num</span>) </span>{
      vm.add(<span class="hljs-built_in">parseInt</span>(num, <span class="hljs-number">10</span>))
    })
  },
  <span class="hljs-attr">methods</span>: {
    add(num) {
      <span class="hljs-keyword">this</span>.count += num
    }
  }
}
&lt;script&gt;</span></code></pre><p>下面代码展示了一个命名为 <code>mip-content.vue</code> 的内容展示组件，我们将通过自定义组件事件方式的通信机制使得 <code>mip-content.vue</code> 和<code>mip-counter.vue</code> 组件进行通信。</p><pre><div class="code-index"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div><div>28</div></div><code class="lang-html"><span class="hljs-comment">&lt;!-- mip-content.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">tempalte</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"onClick"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"show"</span>&gt;</span>点击隐藏内容 counter +1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span>点击显示内容 counter +2<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"show"</span>&gt;</span>
      MIP 提供了强大的组件 DOM 通信，组件间通信功能
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> {
  data() {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">show</span>: <span class="hljs-literal">false</span>
    }
  },
  <span class="hljs-attr">methods</span>: {
    onClick() {
      <span class="hljs-keyword">this</span>.show = !<span class="hljs-keyword">this</span>.show
      <span class="hljs-comment">// 派发 show 事件或close事件</span>
      <span class="hljs-keyword">this</span>.$emit(<span class="hljs-keyword">this</span>.show ? <span class="hljs-string">'show'</span> : <span class="hljs-string">'close'</span>, {})
    }
  }
}
&lt;script&gt;</span></code></pre><p>下面代码展示了最终在 MIP页面中的使用情况。</p><pre><div class="code-index"><div>1</div><div>2</div></div><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">mip-counter</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"counter"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mip-counter</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mip-content</span> <span class="hljs-attr">on</span>=<span class="hljs-string">"show:counter.add(2) close:counter.add(1)"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mip-content</span>&gt;</span></code></pre><p>当运行上面的 MIP 页面后，点击 mip-content 中的「显示内容」，mip-counter 中的 counter 值加 2，点击「隐藏内容」，mip-counter 中的 counter 值加 1。</p><h2 id="特殊对象"><a href="#特殊对象" class="heading-link"><i class="fa fa-link" aria-hidden="true"></i></a>特殊对象</h2><p>前面提到的 <code>on</code> 属性语法的 targetId 除了组件 id，还可以是 MIP 对象，例如下面的用法：</p><pre><div class="code-index"><div>1</div></div><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">on</span>=<span class="hljs-string">"tap:MIP.setData({name:'mip'})"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre><p>我们将 MIP 称之为特殊对象，因为对 targetId 为 MIP 字符串做了特殊处理，使得 MIP 引擎能识别，并可以识别 <code>setData</code> 和 <code>$set</code> 方法，具体可以参考前面 <code>MIP.setData</code> 的用法介绍。目前 MIP 暂时只有MIP一个特殊对象。</p>
    </div>
<div class="markdown-toolbar">
  <a data-type="mip" href="https://github.com/mipengine/mip2/issues/new?title=反馈:docs/guide/mip-advanced/components-event.md"><span>反馈</span></a>
  <a data-type="mip" href="https://github.com/mipengine/mip2/edit/master/docs/guide/mip-advanced/components-event.md"><span>编辑</span></a>
</div>
<div class="markdown-paginator">

  <a class="markdown-paginator-item" data-type="mip" href="/v2/guide/mip-cli/cli-user-plugin.html">
    <p class="label">上一页</p>
    <p class="title">mip2 CLI 用户自定义扩展</p>
  </a>
  <a class="markdown-paginator-item" data-type="mip" href="/v2/guide/mip-advanced/data-from-server.html">
    <p class="label">下一页</p>
    <p class="title">MIP 中与服务端通信</p>
  </a>
</div>
  </div>
</div>
<mip-data>
  <script type="application/json">
    {
      "navbar": [{"name":"首页","path":"docs/index","activeUrl":{},"width":32,"url":"/v2/index.html"},{"name":"学习","width":32,"activeUrl":{},"children":[{"name":"使用文档","path":"docs/guide","width":64,"url":"/v2/guide/basic/newbie.html"},{"name":"组件列表","path":"docs/extensions","width":64,"url":"/v2/components/index.html"},{"name":"API","path":"docs/api","url":"/v2/api/index.html"},{"name":"Codelab","path":"docs/codelabs","width":60,"url":"/v2/codelabs/index.html"}]},{"name":"常用链接","children":[{"name":"MIP 官方博客","url":"http://www.cnblogs.com/mipengine","blank":true},{"name":"MIP-CLI 本地开发工具","url":"https://github.com/mipengine/mip2/tree/master/packages/mip-cli","blank":true},{"name":"MIP 代码校验工具","url":"https://www.mipengine.org/validator/validate","blank":true},{"name":"MIP 效果预览工具","url":"https://www.mipengine.org/validator/preview","blank":true},{"name":"MIP PATH 转换工具","url":"https://www.mipengine.org/mippath.html","blank":true}],"width":82},{"name":"GitHub","url":"https://github.com/mipengine/mip2","blank":true,"width":50},{"name":"回到旧版","url":"https://www.mipengine.org","blank":true,"width":32}],
      "navIndex": "1",
      "sidebarFragment": "guide",
      "sidebarSecondFragment": "guide",
      "menu": [{"name":"简介","path":"docs/guide/basic","children":[{"name":"新手指南","path":"docs/guide/basic/newbie.md","url":"/v2/guide/basic/newbie.html"},{"name":"完整的例子","path":"docs/guide/basic/demo.md","url":"/v2/guide/basic/demo.html"},{"name":"什么是 MIP","path":"docs/guide/basic/what-is-mip.md","url":"/v2/guide/basic/what-is-mip.html"},{"name":"MIP 加速原理","path":"docs/guide/basic/principle-of-mip.md","url":"/v2/guide/basic/principle-of-mip.html"},{"name":"MIP 内容声明","path":"docs/guide/basic/announcement.md","url":"/v2/guide/basic/announcement.html"}]},{"name":"开发规范","path":"docs/guide/mip-standard","children":[{"name":"MIP-HTML 规范","path":"docs/guide/mip-standard/mip-html-spec.md","url":"/v2/guide/mip-standard/mip-html-spec.html"},{"name":"MIP-Cache 规范","path":"docs/guide/mip-standard/mip-cache-spec.md","url":"/v2/guide/mip-standard/mip-cache-spec.html"},{"name":"MIP 校验规则","path":"docs/guide/mip-standard/mip-validate.md","url":"/v2/guide/mip-standard/mip-validate.html"},{"name":"Canonical 使用规范","path":"docs/guide/mip-standard/mip-canonical.md","url":"/v2/guide/mip-standard/mip-canonical.html"},{"name":"组件开发规范","path":"docs/guide/mip-standard/mip-components-spec.md","url":"/v2/guide/mip-standard/mip-components-spec.html"}]},{"name":"MIP 组件机制","path":"docs/guide/component","children":[{"name":"MIP 组件化介绍","path":"docs/guide/component/introduction.md","url":"/v2/guide/component/introduction.html"},{"name":"MIP 组件和 Vue 的关系","path":"docs/guide/component/relationship-between-mip-component-and-vue.md","url":"/v2/guide/component/relationship-between-mip-component-and-vue.html"},{"name":"MIP 2.0 组件实例的生命周期和回调钩子","path":"docs/guide/component/instance-life-cycle.md","url":"/v2/guide/component/instance-life-cycle.html"},{"name":"MIP-HTML 语法和对应 MIP 组件开发介绍","path":"docs/guide/component/syntax.md","url":"/v2/guide/component/syntax.html"},{"name":"插槽","path":"docs/guide/component/slots.md","url":"/v2/guide/component/slots.html"},{"name":"组件布局","path":"docs/guide/component/layout.md","url":"/v2/guide/component/layout.html"},{"name":"沙盒机制","path":"docs/guide/component/sandbox.md","url":"/v2/guide/component/sandbox.html"},{"name":"事件通信","path":"docs/guide/component/actions-and-events.md","url":"/v2/guide/component/actions-and-events.html"},{"name":"组件属性 Props","path":"docs/guide/component/props.md","url":"/v2/guide/component/props.html"}]},{"name":"MIP 组件开发","path":"docs/guide/mip-cli","children":[{"name":"mip2 命令行工具","path":"docs/guide/mip-cli/cli-usage.md","url":"/v2/guide/mip-cli/cli-usage.html"},{"name":"使用 mip-cli 快速开始","path":"docs/guide/mip-cli/start-writing-first-mip.md","url":"/v2/guide/mip-cli/start-writing-first-mip.html"},{"name":"MIP 组件开发","path":"docs/guide/mip-cli/component-development.md","url":"/v2/guide/mip-cli/component-development.html"},{"name":"组件调试","path":"docs/guide/mip-cli/component-testing.md","url":"/v2/guide/mip-cli/component-testing.html"},{"name":"组件部署","path":"docs/guide/mip-cli/component-deploy.md","url":"/v2/guide/mip-cli/component-deploy.html"},{"name":"提交组件到官方组件仓库","path":"docs/guide/mip-cli/contribute-to-official-repo.md","url":"/v2/guide/mip-cli/contribute-to-official-repo.html"},{"name":"提交站长组件","path":"docs/guide/mip-cli/contribute-to-site-extensions-repo.md","url":"/v2/guide/mip-cli/contribute-to-site-extensions-repo.html"},{"name":"mip2 CLI 用户自定义扩展","path":"docs/guide/mip-cli/cli-user-plugin.md","url":"/v2/guide/mip-cli/cli-user-plugin.html"}]},{"name":"进阶教程","path":"docs/guide/mip-advanced","children":[{"name":"MIP 组件间通信","path":"docs/guide/mip-advanced/components-event.md","url":"/v2/guide/mip-advanced/components-event.html"},{"name":"MIP 中与服务端通信","path":"docs/guide/mip-advanced/data-from-server.md","url":"/v2/guide/mip-advanced/data-from-server.html"},{"name":"Promise 在 MIP 中的使用","path":"docs/guide/mip-advanced/promise.md","url":"/v2/guide/mip-advanced/promise.html"},{"name":"MIP 加速原理","path":"docs/guide/mip-advanced/mip-speed-principle.md","url":"/v2/guide/mip-advanced/mip-speed-principle.html"},{"name":"MIP Access 原理剖析","path":"docs/guide/mip-advanced/access-principle.md","url":"/v2/guide/mip-advanced/access-principle.html"},{"name":"离线可用在 MIP 中的实现","path":"docs/guide/mip-advanced/mip-offline.md","url":"/v2/guide/mip-advanced/mip-offline.html"}]},{"name":"MIP 源码解析","path":"docs/guide/mip-source-interpretation","children":[{"name":"MIP 模块简介","path":"docs/guide/mip-source-interpretation/introduction.md","url":"/v2/guide/mip-source-interpretation/introduction.html"},{"name":"MIP 基础模块","path":"docs/guide/mip-source-interpretation/basic.md","url":"/v2/guide/mip-source-interpretation/basic.html"},{"name":"MIP 组件机制详解","path":"docs/guide/mip-source-interpretation/components.md","url":"/v2/guide/mip-source-interpretation/components.html"},{"name":"layout 布局规范","path":"docs/guide/mip-source-interpretation/layout.md","url":"/v2/guide/mip-source-interpretation/layout.html"},{"name":"naboo 动画库","path":"docs/guide/mip-source-interpretation/naboo-animation.md","url":"/v2/guide/mip-source-interpretation/naboo-animation.html"},{"name":"gesture 手势集合","path":"docs/guide/mip-source-interpretation/gesture-sets.md","url":"/v2/guide/mip-source-interpretation/gesture-sets.html"},{"name":"hash 通信机制","path":"docs/guide/mip-source-interpretation/hash.md","url":"/v2/guide/mip-source-interpretation/hash.html"},{"name":"platform 识别","path":"docs/guide/mip-source-interpretation/platform.md","url":"/v2/guide/mip-source-interpretation/platform.html"}]},{"name":"可交互 MIP","path":"docs/guide/interactive-mip","children":[{"name":"可交互 MIP - 概况","path":"docs/guide/interactive-mip/introduction.md","url":"/v2/guide/interactive-mip/introduction.html"},{"name":"mip-data 设置数据","path":"docs/guide/interactive-mip/mip-data.md","url":"/v2/guide/interactive-mip/mip-data.html"},{"name":"mip-bind 绑定数据","path":"docs/guide/interactive-mip/mip-bind.md","url":"/v2/guide/interactive-mip/mip-bind.html"},{"name":"Class 与 Style 绑定","path":"docs/guide/interactive-mip/class-style-binding.md","url":"/v2/guide/interactive-mip/class-style-binding.html"},{"name":"MIP.setData 修改数据","path":"docs/guide/interactive-mip/set-data.md","url":"/v2/guide/interactive-mip/set-data.html"},{"name":"MIP.watch 观察数据","path":"docs/guide/interactive-mip/watch.md","url":"/v2/guide/interactive-mip/watch.html"},{"name":"全局共享数据","path":"docs/guide/interactive-mip/global-data.md","url":"/v2/guide/interactive-mip/global-data.html"},{"name":"mip-script 自定义 JS","path":"docs/guide/interactive-mip/mip-script.md","url":"/v2/guide/interactive-mip/mip-script.html"}]},{"name":"全站 MIP","path":"docs/guide/all-sites-mip","children":[{"name":"全站 MIP 介绍","path":"docs/guide/all-sites-mip/introduction.md","url":"/v2/guide/all-sites-mip/introduction.html"},{"name":"MIP 页面编写规范","path":"docs/guide/all-sites-mip/structure.md","url":"/v2/guide/all-sites-mip/structure.html"},{"name":"页面切换方案","path":"docs/guide/all-sites-mip/switch-page.md","url":"/v2/guide/all-sites-mip/switch-page.html"},{"name":"Page API","path":"docs/guide/all-sites-mip/page-api.md","url":"/v2/guide/all-sites-mip/page-api.html"},{"name":"MIP Shell","path":"docs/guide/all-sites-mip/mip-shell.md","url":"/v2/guide/all-sites-mip/mip-shell.html"},{"name":"MIP Viewer","path":"docs/guide/all-sites-mip/viewer.md","url":"/v2/guide/all-sites-mip/viewer.html"},{"name":"MIP 快捷样式","path":"docs/guide/all-sites-mip/style.md","url":"/v2/guide/all-sites-mip/style.html"}]},{"name":"MIP 搜索生效","path":"docs/guide/mip-in-search","children":[{"name":"搜索识别 MIP 页","path":"docs/guide/mip-in-search/introduction.md","url":"/v2/guide/mip-in-search/introduction.html"},{"name":"MIP 搜索生效流程","path":"docs/guide/mip-in-search/process.md","url":"/v2/guide/mip-in-search/process.html"},{"name":"MIP-Cache","path":"docs/guide/mip-in-search/mip-cache.md","url":"/v2/guide/mip-in-search/mip-cache.html"},{"name":"类原生的 MIP 页面体验","path":"docs/guide/mip-in-search/native-like-mip.md","url":"/v2/guide/mip-in-search/native-like-mip.html"}]}],
      "chapters": [{"level":1,"hash":"#mip-组件通信","text":"MIP 组件通信","children":[{"level":2,"hash":"#eventemitter-简介","text":"EventEmitter 简介"},{"level":2,"hash":"#mip组件事件机制具体实现","text":"MIP组件事件机制具体实现"},{"level":2,"hash":"#组件事件绑定语法","text":"组件事件绑定语法"},{"level":2,"hash":"#自定义组件行为和事件","text":"自定义组件行为和事件"},{"level":2,"hash":"#特殊对象","text":"特殊对象"}]}],
      'url': "/v2/guide/mip-advanced/components-event.html"
    }
  </script>
</mip-data>

    <!-- <script src="http://172.18.19.102:8080/dist/mip.js"></script> -->
    <script src="https://c.mipcdn.com/static/v2/mip.js"></script>
    <!-- <script src="https://bos.nj.bpc.baidu.com/assets/mip/projects/mip.js"></script> -->
    <!-- <script src="http://127.0.0.1:8111/mip-sidenav/mip-sidenav.js"></script> -->
    <script src="https://bos.nj.bpc.baidu.com/assets/mip/temp/mip-sidenav.js?v=194253"></script>
    <script src="https://bos.nj.bpc.baidu.com/assets/mip/codelab/mip-stepper-tabs.js"></script>
<!--     <script src="http://127.0.0.1:8111/mip-stepper-tabs/mip-stepper-tabs.js"></script> -->
    <!-- <script src="https://c.mipcdn.com/static/v1/mip-fixed/mip-fixed.js"></script> -->
    <script src="https://c.mipcdn.com/static/v1/mip-sidebar/mip-sidebar.js"></script>
    <script src="https://c.mipcdn.com/static/v1/mip-showmore/mip-showmore.js"></script>
    <script src="https://c.mipcdn.com/static/v1/mip-toggle/mip-toggle.js"></script>
  </body>
</html>
